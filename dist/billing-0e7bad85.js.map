{"version":3,"file":"billing-0e7bad85.js","mappings":"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","sources":["webpack://checkout/./packages/core/src/app/address/isEqualAddress.ts","webpack://checkout/./packages/core/src/app/address/mapAddressFromFormValues.ts","webpack://checkout/./packages/core/src/app/billing/BillingForm.tsx","webpack://checkout/./packages/core/src/app/billing/getBillingMethodId.ts","webpack://checkout/./packages/core/src/app/billing/Billing.tsx","webpack://checkout/./packages/core/src/app/payment/getPreselectedPayment.ts","webpack://checkout/./packages/core/src/app/shipping/getShippableItemsCount.ts"],"sourcesContent":["import {\n    Address,\n    AddressRequestBody,\n    BillingAddress,\n    CustomerAddress,\n} from '@bigcommerce/checkout-sdk';\nimport { isEqual, omit } from 'lodash';\n\ntype ComparableAddress = CustomerAddress | Address | BillingAddress | AddressRequestBody;\ntype ComparableAddressFields = keyof CustomerAddress | keyof Address | keyof BillingAddress;\n\nexport default function isEqualAddress(\n    address1?: ComparableAddress,\n    address2?: ComparableAddress,\n): boolean {\n    if (!address1 || !address2) {\n        return false;\n    }\n\n    return (\n        isEqual(normalizeAddress(address1), normalizeAddress(address2)) &&\n        isSameState(address1, address2)\n    );\n}\n\nfunction isSameState(address1: ComparableAddress, address2: ComparableAddress): boolean {\n    if (address1.stateOrProvince && address1.stateOrProvince === address2.stateOrProvince) {\n        return true;\n    }\n\n    if (\n        address1.stateOrProvinceCode &&\n        address1.stateOrProvinceCode === address2.stateOrProvinceCode\n    ) {\n        return true;\n    }\n\n    return (\n        address1.stateOrProvince === address2.stateOrProvince &&\n        address1.stateOrProvinceCode === address2.stateOrProvinceCode\n    );\n}\n\nfunction normalizeAddress(address: ComparableAddress) {\n    const ignoredFields: ComparableAddressFields[] = [\n        'id',\n        'shouldSaveAddress',\n        'stateOrProvince',\n        'stateOrProvinceCode',\n        'type',\n        'email',\n        'country',\n    ];\n\n    return omit(\n        {\n            ...address,\n            customFields: (address.customFields || []).filter(({ fieldValue }) => !!fieldValue),\n        },\n        ignoredFields,\n    );\n}\n","import { Address } from '@bigcommerce/checkout-sdk';\n\nimport { mapCustomFormFieldsFromFormValues } from '../formFields';\n\nimport { AddressFormValues } from './mapAddressToFormValues';\n\nexport default function mapAddressFromFormValues(formValues: AddressFormValues): Address {\n    const { customFields, ...address } = formValues;\n    const shouldSaveAddress = formValues.shouldSaveAddress;\n\n    return {\n        ...address,\n        shouldSaveAddress,\n        customFields: mapCustomFormFieldsFromFormValues(customFields),\n    };\n}\n","/* eslint-disable no-console */\nimport {\n  Address,\n  CheckoutSelectors,\n  Country,\n  Customer,\n  // CustomerAddress,\n  FormField,\n} from '@bigcommerce/checkout-sdk';\nimport { FormikProps, withFormik } from 'formik';\nimport React, { RefObject, useEffect, useRef, useState } from 'react';\nimport { lazy } from 'yup';\n\nimport { TranslatedString, withLanguage, WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { usePayPalFastlaneAddress } from '@bigcommerce/checkout/paypal-fastlane-integration';\nimport { AddressFormSkeleton } from '@bigcommerce/checkout/ui';\n\nimport {\n  // AddressForm,\n  AddressFormValues,\n  // AddressSelect,\n  // AddressType,\n  getAddressFormFieldsValidationSchema,\n  getTranslateAddressError,\n  isEqualAddress,\n  // isValidCustomerAddress,\n  mapAddressToFormValues,\n  StaticAddress,\n} from '../address';\nimport { getCustomFormFieldsValidationSchema } from '../formFields';\n// import { OrderComments } from '../orderComments';\nimport { Button, ButtonVariant } from '../ui/button';\nimport { Fieldset, Form } from '../ui/form';\nimport { LoadingOverlay } from '../ui/loading';\n\nimport StaticBillingAddress from './StaticBillingAddress';\n\nimport './BillingForm.scss';\n\nexport type BillingFormValues = AddressFormValues & { orderComment: string };\n\nexport interface BillingFormProps {\n  billingAddress?: Address;\n  countries: Country[];\n  countriesWithAutocomplete: string[];\n  customer: Customer;\n  customerMessage: string;\n  googleMapsApiKey: string;\n  isUpdating: boolean;\n  methodId?: string;\n  shouldShowOrderComments: boolean;\n  isFloatingLabelEnabled?: boolean;\n  getFields(countryCode?: string): FormField[];\n  onSubmit(values: BillingFormValues): void;\n  onUnhandledError(error: Error): void;\n  updateAddress(address: Partial<Address>): Promise<CheckoutSelectors>;\n  selectedShippingAddress: Address;\n}\n\nconst BillingForm = ({\n  // googleMapsApiKey,\n  billingAddress,\n  // countriesWithAutocomplete,\n  customer: {\n    addresses,\n    // isGuest\n  },\n  // getFields,\n  countries,\n  isUpdating,\n  // setFieldValue,\n  //   shouldShowOrderComments,\n  // values,\n  methodId,\n  // isFloatingLabelEnabled,\n  updateAddress,\n  onUnhandledError,\n  selectedShippingAddress,\n}: BillingFormProps & WithLanguageProps & FormikProps<BillingFormValues>) => {\n  const [isResettingAddress, setIsResettingAddress] = useState(false);\n  const addressFormRef: RefObject<HTMLFieldSetElement> = useRef(null);\n  const { isPayPalFastlaneEnabled, paypalFastlaneAddresses } = usePayPalFastlaneAddress();\n\n  const shouldRenderStaticAddress = methodId === 'amazonpay';\n  // const allFormFields = getFields(values.countryCode);\n  // const customFormFields = allFormFields.filter(({ custom }) => custom);\n  // const hasCustomFormFields = customFormFields.length > 0;\n  // const editableFormFields =\n  //   shouldRenderStaticAddress && hasCustomFormFields ? customFormFields : allFormFields;\n  const billingAddresses = isPayPalFastlaneEnabled ? paypalFastlaneAddresses : addresses;\n  const hasAddresses = billingAddresses?.length > 0;\n  // const hasValidCustomerAddress =\n  //   billingAddress &&\n  //   isValidCustomerAddress(billingAddress, billingAddresses, getFields(billingAddress.countryCode));\n  const addressInStore = JSON.parse(localStorage.getItem('billingAddress') || '{}');\n  const [openEdit, setOpenEdit] = useState<boolean>(false);\n\n  console.log('[checkout] billingAddress : ', billingAddress);\n\n  const [tempBillingAddress, setTempBillingAddress] = useState<Address>({\n    ...addressInStore,\n    countryCode: 'US',\n  });\n\n  useEffect(() => {\n    console.log('addressInStore : ', addressInStore);\n\n    setTempBillingAddress({ ...addressInStore, countryCode: 'US', company: '' });\n  }, []);\n\n  const handleSelectAddress = async (address: Partial<Address>) => {\n    setIsResettingAddress(true);\n\n    try {\n      await updateAddress(address);\n    } catch (error) {\n      if (error instanceof Error) {\n        onUnhandledError(error);\n      }\n    } finally {\n      setIsResettingAddress(false);\n    }\n  };\n\n  // const handleUseNewAddress = () => {\n  //   handleSelectAddress({});\n  // };\n\n  // const relatedCustomerAddress = addresses.find((address) =>\n  //   isEqualAddress(address, selectedShippingAddress),\n  // );\n\n  // const billingAddressListToShow = [\n  //   { ...relatedCustomerAddress } as CustomerAddress,\n  //   { ...billingAddress },\n  // ];\n\n  // console.log('[BillingForm] billingAddressListToShow : ', billingAddressListToShow);\n\n  // console.log('[BillingForm] countries : ', countries);\n\n  // console.log('[BillingForm] customFormFields : ', customFormFields);\n  // console.log('[BillingForm] selectedShippingAddress : ', selectedShippingAddress);\n  // console.log('[BillingForm] hasValidCustomerAddress : ', hasValidCustomerAddress);\n  // console.log('[BillingForm] billingAddress : ', billingAddress);\n  // console.log('[BillingForm] addresses : ', addresses);\n\n  const handleSubmit = (e: any) => {\n    e.preventDefault();\n\n    // console.log('[BillingForm] handleSubmit : ', tempBillingAddress);\n    // localStorage.setItem('billingAddress', JSON.stringify(tempBillingAddress));\n    // handleSelectAddress(tempBillingAddress as CustomerAddress);\n  };\n\n  // const handleCloseEditAddressModal = () => {\n  //   handleSelectAddress(relatedCustomerAddress as CustomerAddress);\n  // };\n\n  return (\n    <Form autoComplete=\"on\">\n      {shouldRenderStaticAddress && billingAddress && (\n        <div className=\"form-fieldset\">\n          <StaticBillingAddress address={billingAddress} />\n        </div>\n      )}\n      <Fieldset id=\"checkoutBillingAddress\" ref={addressFormRef}>\n        {hasAddresses && !shouldRenderStaticAddress && !openEdit && (\n          <Fieldset id=\"billingAddresses\">\n            <LoadingOverlay isLoading={isResettingAddress}>\n              <div className=\"custom-billing-address-list\">\n                {[{ ...selectedShippingAddress }, { ...tempBillingAddress }].map(\n                  (address, index: number) => {\n                    return (\n                      <div\n                        className=\"custom-billing-address-container\"\n                        key={index}\n                        onClick={() => handleSelectAddress(address)}\n                      >\n                        <div className=\"custom-billing-address\">\n                          <input\n                            checked={isEqualAddress(address, billingAddress as Address)}\n                            className=\"billing-address-input\"\n                            type=\"radio\"\n                          />\n                          <div className=\"billing-address-container\">\n                            <StaticAddress address={address as Address} />\n                          </div>\n                        </div>\n                        {isEqualAddress(address, selectedShippingAddress) && (\n                          <div className=\"billing-addres-same-shipping-label\">\n                            same as shipping address\n                          </div>\n                        )}\n                        {isEqualAddress(address, tempBillingAddress) && (\n                          <div\n                            className=\"billing-addres-edit-label\"\n                            onClick={() => setOpenEdit(true)}\n                          >\n                            edit\n                          </div>\n                        )}\n                      </div>\n                    );\n                  },\n                )}\n              </div>\n              {/* <AddressSelect\n                addresses={[{ ...relatedCustomerAddress } as CustomerAddress]}\n                onSelectAddress={handleSelectAddress}\n                onUseNewAddress={handleUseNewAddress}\n                selectedAddress={hasValidCustomerAddress ? billingAddress : undefined}\n                type={AddressType.Billing}\n              /> */}\n            </LoadingOverlay>\n          </Fieldset>\n        )}\n\n        {openEdit && (\n          <AddressFormSkeleton isLoading={isResettingAddress}>\n            <form onSubmit={handleSubmit}>\n              <div className=\"temp-billing-address-container\">\n                <div className=\"temp-billing-address-name-container\">\n                  <div className=\"temp-billing-address-firstname\">\n                    <input\n                      className=\"temp-billing-address-firstname-input\"\n                      id=\"firstName\"\n                      name=\"firstName\"\n                      onChange={(e) =>\n                        setTempBillingAddress({ ...tempBillingAddress, firstName: e.target.value })\n                      }\n                      placeholder=\"First Name\"\n                      type=\"text\"\n                      value={tempBillingAddress.firstName}\n                    />\n                  </div>\n                  <div className=\"temp-billing-address-lastname\">\n                    <input\n                      className=\"temp-billing-address-lastname-input\"\n                      id=\"lastName\"\n                      name=\"lastName\"\n                      onChange={(e) => {\n                        setTempBillingAddress({ ...tempBillingAddress, lastName: e.target.value });\n                      }}\n                      placeholder=\"Last Name\"\n                      type=\"text\"\n                      value={tempBillingAddress.lastName}\n                    />\n                  </div>\n                </div>\n                <div className=\"temp-billing-address1-container\">\n                  <input\n                    className=\"temp-billing-address1-input\"\n                    id=\"address1\"\n                    name=\"address1\"\n                    onChange={(e) =>\n                      setTempBillingAddress({ ...tempBillingAddress, address1: e.target.value })\n                    }\n                    placeholder=\"Address\"\n                    type=\"text\"\n                    value={tempBillingAddress.address1}\n                  />\n                </div>\n                <div className=\"temp-billing-address2-container\">\n                  <input\n                    className=\"temp-billing-address2-input\"\n                    id=\"address2\"\n                    name=\"address2\"\n                    onChange={(e) =>\n                      setTempBillingAddress({ ...tempBillingAddress, address2: e.target.value })\n                    }\n                    placeholder=\"Address\"\n                    type=\"text\"\n                    value={tempBillingAddress.address2}\n                  />\n                </div>\n                <div className=\"temp-billing-address-country-container\">\n                  <select\n                    className=\"temp-billing-address-country-select\"\n                    onChange={(e) =>\n                      setTempBillingAddress({ ...tempBillingAddress, countryCode: e.target.value })\n                    }\n                    value={tempBillingAddress.countryCode || 'US'}\n                  >\n                    {countries.map((country) => (\n                      <option key={country.code} value={country.code}>\n                        {country.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <div className=\"temp-billing-address-state-city-container\">\n                  <div className=\"temp-billing-address-state\">\n                    {(\n                      countries?.find((c) => c.code === tempBillingAddress.countryCode)\n                        ?.subdivisions ?? []\n                    )?.length > 0 ? (\n                      <div className=\"temp-billing-address-state-container\">\n                        <select\n                          className=\"temp-billing-address-state-select\"\n                          onChange={(e) =>\n                            setTempBillingAddress({\n                              ...tempBillingAddress,\n                              stateOrProvince: e.target.value,\n                            })\n                          }\n                          value={tempBillingAddress.stateOrProvince}\n                        >\n                          {(\n                            countries?.find((c) => c.code === tempBillingAddress.countryCode)\n                              ?.subdivisions ?? []\n                          ).map((state) => (\n                            <option key={state.code} value={state.code}>\n                              {state.name}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                    ) : (\n                      <div className=\"temp-billing-address-state-container\">\n                        <input\n                          className=\"temp-billing-address-state-select\"\n                          id=\"stateOrProvince\"\n                          name=\"stateOrProvince\"\n                          onChange={(e) =>\n                            setTempBillingAddress({\n                              ...tempBillingAddress,\n                              stateOrProvince: e.target.value,\n                            })\n                          }\n                          placeholder=\"State Or Province\"\n                          type=\"text\"\n                          value={tempBillingAddress.stateOrProvince}\n                        />\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"temp-billing-address-city-container\">\n                    <input\n                      className=\"temp-billing-address-city-input\"\n                      id=\"city\"\n                      name=\"city\"\n                      onChange={(e) =>\n                        setTempBillingAddress({ ...tempBillingAddress, city: e.target.value })\n                      }\n                      placeholder=\"City\"\n                      type=\"text\"\n                      value={tempBillingAddress.city}\n                    />\n                  </div>\n                </div>\n                <div className=\"temp-billing-address-postalcode-phone-container\">\n                  <div className=\"temp-billing-address-postalcode-container\">\n                    <input\n                      className=\"temp-billing-address-postalcode-input\"\n                      id=\"postalCode\"\n                      name=\"postalCode\"\n                      onChange={(e) =>\n                        setTempBillingAddress({ ...tempBillingAddress, postalCode: e.target.value })\n                      }\n                      placeholder=\"Postal Code\"\n                      type=\"text\"\n                      value={tempBillingAddress.postalCode}\n                    />\n                  </div>\n                  <div className=\"temp-billing-address-phone-container\">\n                    <input\n                      className=\"temp-billing-address-phone-input\"\n                      id=\"phone\"\n                      name=\"phone\"\n                      onChange={(e) => {\n                        setTempBillingAddress({ ...tempBillingAddress, phone: e.target.value });\n                      }}\n                      placeholder=\"Phone\"\n                      type=\"text\"\n                      value={tempBillingAddress.phone}\n                    />\n                  </div>\n                </div>\n                <div className=\"temp-billing-address-button-container\">\n                  <button\n                    className=\"temp-billing-address-cancel-button\"\n                    onClick={() => setOpenEdit(false)}\n                  >\n                    Cancel\n                  </button>\n                  <button className=\"temp-billing-address-save-button\" type=\"submit\">\n                    Save\n                  </button>\n                </div>\n              </div>\n            </form>\n          </AddressFormSkeleton>\n        )}\n\n        {/* {!hasValidCustomerAddress && (\n          <AddressFormSkeleton isLoading={isResettingAddress}>\n            <AddressForm\n              countries={countries}\n              countriesWithAutocomplete={countriesWithAutocomplete}\n              countryCode={values.countryCode}\n              formFields={editableFormFields}\n              googleMapsApiKey={googleMapsApiKey}\n              isFloatingLabelEnabled={isFloatingLabelEnabled}\n              setFieldValue={setFieldValue}\n              shouldShowSaveAddress={!isGuest}\n            />\n          </AddressFormSkeleton>\n        )} */}\n      </Fieldset>\n      {/* {shouldShowOrderComments && <OrderComments />} */}\n      <div className=\"form-actions\">\n        <Button\n          disabled={isUpdating || isResettingAddress}\n          id=\"checkout-billing-continue\"\n          isLoading={isUpdating || isResettingAddress}\n          type=\"submit\"\n          variant={ButtonVariant.Primary}\n        >\n          <TranslatedString id=\"common.continue_action\" />\n        </Button>\n      </div>\n    </Form>\n  );\n};\n\nexport default withLanguage(\n  withFormik<BillingFormProps & WithLanguageProps, BillingFormValues>({\n    handleSubmit: (values, { props: { onSubmit } }) => {\n      onSubmit(values);\n    },\n    mapPropsToValues: ({ getFields, customerMessage, billingAddress }) => ({\n      ...mapAddressToFormValues(\n        getFields(billingAddress && billingAddress.countryCode),\n        billingAddress,\n      ),\n      orderComment: customerMessage,\n    }),\n    isInitialValid: ({ billingAddress, getFields, language }) =>\n      !!billingAddress &&\n      getAddressFormFieldsValidationSchema({\n        language,\n        formFields: getFields(billingAddress.countryCode),\n      }).isValidSync(billingAddress),\n    validationSchema: ({ language, getFields, methodId }: BillingFormProps & WithLanguageProps) =>\n      methodId === 'amazonpay'\n        ? lazy<Partial<AddressFormValues>>((values) =>\n            getCustomFormFieldsValidationSchema({\n              translate: getTranslateAddressError(language),\n              formFields: getFields(values && values.countryCode),\n            }),\n          )\n        : lazy<Partial<AddressFormValues>>((values) =>\n            getAddressFormFieldsValidationSchema({\n              language,\n              formFields: getFields(values && values.countryCode),\n            }),\n          ),\n    enableReinitialize: true,\n  })(BillingForm),\n);\n","import { Checkout } from '@bigcommerce/checkout-sdk';\n\nimport { getPreselectedPayment } from '../payment';\n\nexport default function getBillingMethodId(checkout: Checkout): string | undefined {\n    const BILLING_METHOD_IDS = ['amazonpay'];\n    const preselectedPayment = getPreselectedPayment(checkout);\n\n    return preselectedPayment && BILLING_METHOD_IDS.indexOf(preselectedPayment.providerId) > -1\n        ? preselectedPayment.providerId\n        : undefined;\n}\n","/* eslint-disable no-console */\nimport {\n  Address,\n  CheckoutRequestBody,\n  CheckoutSelectors,\n  Country,\n  Customer,\n  FormField,\n} from '@bigcommerce/checkout-sdk';\nimport { noop } from 'lodash';\nimport React, { Component, ReactNode } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { CheckoutContextProps } from '@bigcommerce/checkout/payment-integration-api';\nimport { AddressFormSkeleton } from '@bigcommerce/checkout/ui';\n\nimport { isEqualAddress, mapAddressFromFormValues } from '../address';\nimport { withCheckout } from '../checkout';\nimport { EMPTY_ARRAY, isFloatingLabelEnabled } from '../common/utility';\nimport { getShippableItemsCount } from '../shipping';\nimport { Legend } from '../ui/form';\n\nimport BillingForm, { BillingFormValues } from './BillingForm';\nimport getBillingMethodId from './getBillingMethodId';\n\nexport interface BillingProps {\n  navigateNextStep(): void;\n  onReady?(): void;\n  onUnhandledError(error: Error): void;\n}\n\nexport interface WithCheckoutBillingProps {\n  countries: Country[];\n  countriesWithAutocomplete: string[];\n  customer: Customer;\n  customerMessage: string;\n  googleMapsApiKey: string;\n  isInitializing: boolean;\n  isUpdating: boolean;\n  shouldShowOrderComments: boolean;\n  billingAddress?: Address;\n  methodId?: string;\n  isFloatingLabelEnabled?: boolean;\n  getFields(countryCode?: string): FormField[];\n  initialize(): Promise<CheckoutSelectors>;\n  updateAddress(address: Partial<Address>): Promise<CheckoutSelectors>;\n  updateCheckout(payload: CheckoutRequestBody): Promise<CheckoutSelectors>;\n  selectedShippingAddress: Address;\n}\n\nclass Billing extends Component<BillingProps & WithCheckoutBillingProps> {\n  async componentDidMount(): Promise<void> {\n    const { initialize, onReady = noop, onUnhandledError } = this.props;\n\n    try {\n      await initialize();\n      onReady();\n    } catch (error) {\n      if (error instanceof Error) {\n        onUnhandledError(error);\n      }\n    }\n  }\n\n  render(): ReactNode {\n    const { updateAddress, isInitializing, selectedShippingAddress, ...props } = this.props;\n\n    console.log('selectedShippingAddress : ', selectedShippingAddress);\n    console.log('[this.props] billingAddress : ', this.props.billingAddress);\n\n    return (\n      <AddressFormSkeleton isLoading={isInitializing}>\n        <div className=\"checkout-form\">\n          <div className=\"form-legend-container\">\n            <Legend testId=\"billing-address-heading\">\n              <TranslatedString id=\"billing.billing_address_heading\" />\n            </Legend>\n          </div>\n          <BillingForm\n            {...props}\n            onSubmit={this.handleSubmit}\n            selectedShippingAddress={selectedShippingAddress}\n            updateAddress={updateAddress}\n          />\n        </div>\n      </AddressFormSkeleton>\n    );\n  }\n\n  private handleSubmit: (values: BillingFormValues) => void = async ({\n    orderComment,\n    ...addressValues\n  }) => {\n    const {\n      updateAddress,\n      updateCheckout,\n      customerMessage,\n      billingAddress,\n      navigateNextStep,\n      onUnhandledError,\n    } = this.props;\n\n    const promises: Array<Promise<CheckoutSelectors>> = [];\n    const address = mapAddressFromFormValues(addressValues);\n\n    if (address && !isEqualAddress(address, billingAddress)) {\n      promises.push(updateAddress(address));\n    }\n\n    if (customerMessage !== orderComment) {\n      promises.push(updateCheckout({ customerMessage: orderComment }));\n    }\n\n    try {\n      await Promise.all(promises);\n\n      navigateNextStep();\n    } catch (error) {\n      if (error instanceof Error) {\n        onUnhandledError(error);\n      }\n    }\n  };\n}\n\nfunction mapToBillingProps({\n  checkoutService,\n  checkoutState,\n}: CheckoutContextProps): WithCheckoutBillingProps | null {\n  const {\n    data: {\n      getCheckout,\n      getConfig,\n      getCart,\n      getCustomer,\n      getBillingAddress,\n      getBillingAddressFields,\n      getBillingCountries,\n      getShippingAddress,\n    },\n    statuses: { isLoadingBillingCountries, isUpdatingBillingAddress, isUpdatingCheckout },\n  } = checkoutState;\n\n  const config = getConfig();\n  const customer = getCustomer();\n  const checkout = getCheckout();\n  const cart = getCart();\n\n  if (!config || !customer || !checkout || !cart) {\n    return null;\n  }\n\n  const { enableOrderComments, googleMapsApiKey } = config.checkoutSettings;\n\n  const countriesWithAutocomplete = ['US', 'CA', 'AU', 'NZ', 'GB'];\n\n  return {\n    billingAddress: getBillingAddress(),\n    countries: getBillingCountries() || EMPTY_ARRAY,\n    countriesWithAutocomplete,\n    customer,\n    customerMessage: checkout.customerMessage,\n    getFields: getBillingAddressFields,\n    googleMapsApiKey,\n    initialize: checkoutService.loadBillingAddressFields,\n    isInitializing: isLoadingBillingCountries(),\n    isUpdating: isUpdatingBillingAddress() || isUpdatingCheckout(),\n    methodId: getBillingMethodId(checkout),\n    shouldShowOrderComments: enableOrderComments && getShippableItemsCount(cart) < 1,\n    updateAddress: checkoutService.updateBillingAddress,\n    updateCheckout: checkoutService.updateCheckout,\n    isFloatingLabelEnabled: isFloatingLabelEnabled(config.checkoutSettings),\n    selectedShippingAddress: getShippingAddress() || ({} as Address),\n  };\n}\n\nexport default withCheckout(mapToBillingProps)(Billing);\n","import { Checkout, CheckoutPayment } from '@bigcommerce/checkout-sdk';\n\nimport { isGiftCertificatePayment } from '../giftCertificate';\n\nimport { isStoreCreditPayment } from './storeCredit';\n\nexport default function getPreselectedPayment(checkout: Checkout): CheckoutPayment | undefined {\n    const payments = checkout && checkout.payments ? checkout.payments : [];\n\n    return payments.find(\n        (payment) =>\n            !isGiftCertificatePayment(payment) &&\n            !isStoreCreditPayment(payment) &&\n            !!payment.providerId,\n    );\n}\n","import { Cart } from '@bigcommerce/checkout-sdk';\n\nimport getLineItemsCount from './getLineItemsCount';\n\nexport default function getShippableItemsCount(cart: Cart): number {\n    return getLineItemsCount(cart.lineItems.physicalItems.filter((item) => !item.addedByPromotion));\n}\n"],"names":["isEqualAddress","address1","address2","isEqual","normalizeAddress","stateOrProvince","stateOrProvinceCode","isSameState","address","omit","customFields","filter","mapAddressFromFormValues","formValues","shouldSaveAddress","withLanguage","withFormik","handleSubmit","values","onSubmit","mapPropsToValues","getFields","customerMessage","billingAddress","mapAddressToFormValues","countryCode","orderComment","isInitialValid","language","getAddressFormFieldsValidationSchema","formFields","isValidSync","validationSchema","getCustomFormFieldsValidationSchema","translate","enableReinitialize","addresses","countries","isUpdating","methodId","updateAddress","onUnhandledError","selectedShippingAddress","useState","isResettingAddress","setIsResettingAddress","addressFormRef","useRef","usePayPalFastlaneAddress","isPayPalFastlaneEnabled","paypalFastlaneAddresses","shouldRenderStaticAddress","billingAddresses","hasAddresses","length","addressInStore","JSON","parse","localStorage","getItem","openEdit","setOpenEdit","console","log","tempBillingAddress","setTempBillingAddress","useEffect","company","Form","autoComplete","className","StaticBillingAddress","Fieldset","id","ref","LoadingOverlay","isLoading","map","index","key","onClick","Error","handleSelectAddress","checked","type","StaticAddress","AddressFormSkeleton","e","preventDefault","name","onChange","firstName","target","value","placeholder","lastName","country","code","find","c","subdivisions","state","city","postalCode","phone","Button","disabled","variant","TranslatedString","getBillingMethodId","checkout","preselectedPayment","getPreselectedPayment","indexOf","providerId","undefined","addressValues","this","props","updateCheckout","navigateNextStep","promises","push","Promise","all","componentDidMount","initialize","onReady","noop","render","isInitializing","Legend","testId","Component","withCheckout","checkoutService","checkoutState","getCheckout","getConfig","getCart","getCustomer","getBillingAddress","getBillingAddressFields","getBillingCountries","getShippingAddress","isLoadingBillingCountries","isUpdatingBillingAddress","isUpdatingCheckout","config","customer","cart","checkoutSettings","enableOrderComments","googleMapsApiKey","countriesWithAutocomplete","loadBillingAddressFields","shouldShowOrderComments","getShippableItemsCount","updateBillingAddress","isFloatingLabelEnabled","Billing","payments","payment","lineItems","physicalItems","item","addedByPromotion"],"sourceRoot":""}